Routes/courses.js

```javascript
var express = require('express');
var router = express.Router();
var courseControllers = require('../controllers/courseController');
//输入的url后面是这玩意，就跳到后面这个函数
router.get('/class/:courseNumber', courseControllers.getUserCoursePage);

router.get('/',courseControllers.getAllCourse);
router.get('/search/:courseName', courseControllers.getCourseByName);

router.get('/:courseNumber', courseControllers.getCourseInfo);

module.exports = router;
```

controllers/courseControlllers

```javascript
var Course = require('../models/class/Course');


exports.getCourseByName = async (req, res) => {
    //调用course类的getCourseByName方法，req.params.courseName是通过url解析出来的“/search/:courseName”<-，结果存在courseList里
    var courseList = await Course.prototype.getCourseByName(req.params.courseName);
    var courseTeacherList = await Course.prototype.getCourseTeacher(req.params.courseName);
    //把courseList传过去，可以在ejs里通过courseList用这个变量
    res.render('courses/courseInfo',{courseList:courseList},{teacherList:courseTeacherList});
}
```



class/Course

```javascript
var pool = require('../mysql/ConnPool');

class Course {
    /**
     * 全部课程-返回全部课程
     * @return {Array} 返回全部课程组成的JSON对象数组，否则返回空数组
     */
    async getAllCourse()
    {
        try{
            //连接
            var conn = await pool.getConnection();
            //执行sql语句
            var ret = await conn.query("select * from course");
            //返回结果
            return ret[0];
        }catch (err) {
            console.log(err);
            return null;
        } finally {
            conn.release();
        }
    }
```

Course.ejs

```ejs
<% if (courseList == null) { %>
    <!--待替换-->
    <% } else { %>
        <% for(var i = 0; i < courseList.length; i++) { %>
            <% var course = courseList[i]; %>
                <div class="item">
                    <div class="ui segment ">
                        <div class="one wide column">
                            <!--<%= course.coursePhoto %>-->
                            <img src='/images/cmdc1.png'>
                                </div>
                        <div class="eight wide column">
                            <h4 class="header"><%= course.courseName %></h4>
                            <div class="description">
                                <%= course.description %>
                            </div>
                        </div>
                    </div>
            </div>
            <% } %>
            <% } %>
```

具体语法看ejs模板